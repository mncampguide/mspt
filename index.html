<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="initial-scale=1,user-scalable=no,maximum-scale=1,width=device-width">
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <link rel="stylesheet" href="./resources/ol.css">
        <link rel="stylesheet" href="resources/fontawesome-all.min.css">
        <link rel="stylesheet" href="./resources/ol-layerswitcher.css">
        <link rel="stylesheet" href="./resources/qgis2web.css">
        
        <style>
        html, body {
            background-color: #ffffff;
        }
        .ol-control > * {
            background-color: #f8f8f8!important;
            color: #444444!important;
            border-radius: 0px;
        }
        .ol-attribution a, .gcd-gl-input::placeholder, .search-layer-input-search::placeholder {
            color: #444444!important;
        }
        .search-layer-input-search {
            background-color: #f8f8f8!important;
        }
        .ol-control > *:focus, .ol-control >*:hover {
            background-color: rgba(248, 248, 248, 0.7)!important;
        } 
        .ol-control {
            background-color: rgba(255,255,255,.4) !important;
            padding: 2px !important;
        } 
        </style>

        <style>
        html, body, #map {
            width: 100%;
            height: 100%;
            padding: 0;
            margin: 0;
        }
        </style>
        <title>The_MSPT (QFieldCloud)</title>
    </head>
    <body>
        <div id="map">
            <div id="popup" class="ol-popup">
                <a href="#" id="popup-closer" class="ol-popup-closer"></a>
                <div id="popup-content"></div>
            </div>
        </div>
        <script src="resources/qgis2web_expressions.js"></script>
        <script src="./resources/functions.js"></script>
        <script src="./resources/ol.js"></script>
        <script src="./resources/ol-layerswitcher.js"></script>
        <script src="layers/Scouting_2.js"></script><script src="layers/Nature_Interp_3.js"></script><script src="layers/Historical_Interp_4.js"></script><script src="layers/S23__5.js"></script><script src="layers/railroadwalk_6.js"></script><script src="layers/lilydale_claypit_fence_7.js"></script><script src="layers/Trail_Obstacles_8.js"></script><script src="layers/Pickerel_Lake_Approach_9.js"></script><script src="layers/S1_10.js"></script><script src="layers/S2_11.js"></script><script src="layers/S3_12.js"></script><script src="layers/S4_13.js"></script><script src="layers/S5_14.js"></script><script src="layers/S6_15.js"></script><script src="layers/S7_16.js"></script><script src="layers/S8_17.js"></script><script src="layers/S9_18.js"></script><script src="layers/S10_19.js"></script><script src="layers/S10B_20.js"></script><script src="layers/S11_21.js"></script><script src="layers/S12_22.js"></script><script src="layers/S125_23.js"></script><script src="layers/S13_24.js"></script><script src="layers/S13B_25.js"></script><script src="layers/S14_26.js"></script><script src="layers/S15_27.js"></script><script src="layers/S15B_28.js"></script><script src="layers/S16_29.js"></script><script src="layers/S17_30.js"></script><script src="layers/S17B_31.js"></script><script src="layers/S17C_32.js"></script><script src="layers/S18_33.js"></script><script src="layers/S19_34.js"></script><script src="layers/S19BSPUR1_35.js"></script><script src="layers/S19BSPUR2_36.js"></script><script src="layers/S20_37.js"></script><script src="layers/S21_38.js"></script><script src="layers/S22_39.js"></script><script src="layers/S23_40.js"></script><script src="layers/S23B_41.js"></script><script src="layers/S23BSPUR_42.js"></script><script src="layers/S24_43.js"></script><script src="layers/S25_44.js"></script><script src="layers/S25LS_45.js"></script><script src="layers/S26LS_46.js"></script><script src="layers/S27_47.js"></script><script src="layers/S28LS_48.js"></script><script src="layers/S30_49.js"></script><script src="layers/S30B_50.js"></script><script src="layers/S31_51.js"></script><script src="layers/S31B_52.js"></script><script src="layers/S31LOW_53.js"></script><script src="layers/S32_54.js"></script><script src="layers/S32LOW_55.js"></script><script src="layers/S33_56.js"></script><script src="layers/S33LOW_57.js"></script><script src="layers/S33UP_58.js"></script><script src="layers/S34_59.js"></script><script src="layers/S34LOW_60.js"></script><script src="layers/S34UP_61.js"></script><script src="layers/S35_62.js"></script><script src="layers/S35B_63.js"></script><script src="layers/S35UP_64.js"></script><script src="layers/S36_65.js"></script><script src="layers/S37_66.js"></script><script src="layers/S38_67.js"></script><script src="layers/S39_68.js"></script><script src="layers/S40_69.js"></script><script src="layers/S41_70.js"></script><script src="layers/S42_71.js"></script><script src="layers/N2_72.js"></script><script src="layers/N3_73.js"></script><script src="layers/N4_74.js"></script><script src="layers/N5_75.js"></script><script src="layers/N6_76.js"></script><script src="layers/N7_77.js"></script><script src="layers/N7B_78.js"></script><script src="layers/N8_79.js"></script><script src="layers/N8B_80.js"></script><script src="layers/N9_81.js"></script><script src="layers/N10_82.js"></script><script src="layers/N11_83.js"></script><script src="layers/N12_84.js"></script><script src="layers/N13_85.js"></script><script src="layers/N14_86.js"></script><script src="layers/N15_87.js"></script><script src="layers/N16_88.js"></script><script src="layers/N17_89.js"></script><script src="layers/N17B_90.js"></script><script src="layers/N18_91.js"></script><script src="layers/N19_92.js"></script><script src="layers/N20_93.js"></script><script src="layers/N20B_94.js"></script><script src="layers/N21B_95.js"></script><script src="layers/N21_96.js"></script><script src="layers/N23UP_97.js"></script><script src="layers/N23LOW_98.js"></script><script src="layers/N24UP_99.js"></script><script src="layers/N25B_100.js"></script><script src="layers/N25UP_101.js"></script><script src="layers/N26_102.js"></script><script src="layers/N27_103.js"></script><script src="layers/N27SPUR_104.js"></script><script src="layers/N28_105.js"></script><script src="layers/N29_106.js"></script><script src="layers/N30_107.js"></script><script src="layers/N30B_108.js"></script><script src="layers/N31_109.js"></script><script src="layers/N31B_110.js"></script><script src="layers/N31C_111.js"></script><script src="layers/N32_112.js"></script><script src="layers/N33_113.js"></script>
        <script src="styles/Scouting_2_style.js"></script><script src="styles/Nature_Interp_3_style.js"></script><script src="styles/Historical_Interp_4_style.js"></script><script src="styles/S23__5_style.js"></script><script src="styles/railroadwalk_6_style.js"></script><script src="styles/lilydale_claypit_fence_7_style.js"></script><script src="styles/Trail_Obstacles_8_style.js"></script><script src="styles/Pickerel_Lake_Approach_9_style.js"></script><script src="styles/S1_10_style.js"></script><script src="styles/S2_11_style.js"></script><script src="styles/S3_12_style.js"></script><script src="styles/S4_13_style.js"></script><script src="styles/S5_14_style.js"></script><script src="styles/S6_15_style.js"></script><script src="styles/S7_16_style.js"></script><script src="styles/S8_17_style.js"></script><script src="styles/S9_18_style.js"></script><script src="styles/S10_19_style.js"></script><script src="styles/S10B_20_style.js"></script><script src="styles/S11_21_style.js"></script><script src="styles/S12_22_style.js"></script><script src="styles/S125_23_style.js"></script><script src="styles/S13_24_style.js"></script><script src="styles/S13B_25_style.js"></script><script src="styles/S14_26_style.js"></script><script src="styles/S15_27_style.js"></script><script src="styles/S15B_28_style.js"></script><script src="styles/S16_29_style.js"></script><script src="styles/S17_30_style.js"></script><script src="styles/S17B_31_style.js"></script><script src="styles/S17C_32_style.js"></script><script src="styles/S18_33_style.js"></script><script src="styles/S19_34_style.js"></script><script src="styles/S19BSPUR1_35_style.js"></script><script src="styles/S19BSPUR2_36_style.js"></script><script src="styles/S20_37_style.js"></script><script src="styles/S21_38_style.js"></script><script src="styles/S22_39_style.js"></script><script src="styles/S23_40_style.js"></script><script src="styles/S23B_41_style.js"></script><script src="styles/S23BSPUR_42_style.js"></script><script src="styles/S24_43_style.js"></script><script src="styles/S25_44_style.js"></script><script src="styles/S25LS_45_style.js"></script><script src="styles/S26LS_46_style.js"></script><script src="styles/S27_47_style.js"></script><script src="styles/S28LS_48_style.js"></script><script src="styles/S30_49_style.js"></script><script src="styles/S30B_50_style.js"></script><script src="styles/S31_51_style.js"></script><script src="styles/S31B_52_style.js"></script><script src="styles/S31LOW_53_style.js"></script><script src="styles/S32_54_style.js"></script><script src="styles/S32LOW_55_style.js"></script><script src="styles/S33_56_style.js"></script><script src="styles/S33LOW_57_style.js"></script><script src="styles/S33UP_58_style.js"></script><script src="styles/S34_59_style.js"></script><script src="styles/S34LOW_60_style.js"></script><script src="styles/S34UP_61_style.js"></script><script src="styles/S35_62_style.js"></script><script src="styles/S35B_63_style.js"></script><script src="styles/S35UP_64_style.js"></script><script src="styles/S36_65_style.js"></script><script src="styles/S37_66_style.js"></script><script src="styles/S38_67_style.js"></script><script src="styles/S39_68_style.js"></script><script src="styles/S40_69_style.js"></script><script src="styles/S41_70_style.js"></script><script src="styles/S42_71_style.js"></script><script src="styles/N2_72_style.js"></script><script src="styles/N3_73_style.js"></script><script src="styles/N4_74_style.js"></script><script src="styles/N5_75_style.js"></script><script src="styles/N6_76_style.js"></script><script src="styles/N7_77_style.js"></script><script src="styles/N7B_78_style.js"></script><script src="styles/N8_79_style.js"></script><script src="styles/N8B_80_style.js"></script><script src="styles/N9_81_style.js"></script><script src="styles/N10_82_style.js"></script><script src="styles/N11_83_style.js"></script><script src="styles/N12_84_style.js"></script><script src="styles/N13_85_style.js"></script><script src="styles/N14_86_style.js"></script><script src="styles/N15_87_style.js"></script><script src="styles/N16_88_style.js"></script><script src="styles/N17_89_style.js"></script><script src="styles/N17B_90_style.js"></script><script src="styles/N18_91_style.js"></script><script src="styles/N19_92_style.js"></script><script src="styles/N20_93_style.js"></script><script src="styles/N20B_94_style.js"></script><script src="styles/N21B_95_style.js"></script><script src="styles/N21_96_style.js"></script><script src="styles/N23UP_97_style.js"></script><script src="styles/N23LOW_98_style.js"></script><script src="styles/N24UP_99_style.js"></script><script src="styles/N25B_100_style.js"></script><script src="styles/N25UP_101_style.js"></script><script src="styles/N26_102_style.js"></script><script src="styles/N27_103_style.js"></script><script src="styles/N27SPUR_104_style.js"></script><script src="styles/N28_105_style.js"></script><script src="styles/N29_106_style.js"></script><script src="styles/N30_107_style.js"></script><script src="styles/N30B_108_style.js"></script><script src="styles/N31_109_style.js"></script><script src="styles/N31B_110_style.js"></script><script src="styles/N31C_111_style.js"></script><script src="styles/N32_112_style.js"></script><script src="styles/N33_113_style.js"></script>
        <script src="./layers/layers.js" type="text/javascript"></script> 
        <script src="./resources/Autolinker.min.js"></script>
        <script src="./resources/qgis2web.js"></script>
        <script>
            // Wait until the map is initialized
            window.onload = function () {
                // Try to find the OpenLayers map object
                const map = window.map; // Assumes your main map is attached to `window.map`

                if (!map) {
                    console.error("Map object not found. Make sure the map is assigned to `window.map`.");
                    return;
                }

                // Create a layer for user location
                const userLocationLayer = new ol.layer.Vector({
                    source: new ol.source.Vector(),
                    style: new ol.style.Style({
                        image: new ol.style.Circle({
                            radius: 6,
                            fill: new ol.style.Fill({ color: 'blue' }),
                            stroke: new ol.style.Stroke({ color: 'white', width: 2 })
                        })
                    })
                });

                map.addLayer(userLocationLayer);

                // Get user location and add to map
                if ('geolocation' in navigator) {
                    navigator.geolocation.getCurrentPosition(function (position) {
                        const userLonLat = [position.coords.longitude, position.coords.latitude];
                        const userWebMercator = ol.proj.fromLonLat(userLonLat);

                        const userFeature = new ol.Feature(new ol.geom.Point(userWebMercator));
                        userLocationLayer.getSource().addFeature(userFeature);

                        map.getView().animate({ center: userWebMercator, zoom: 16 });
                    }, function (error) {
                        console.warn('Geolocation error:', error.message);
                    }, {
                        enableHighAccuracy: true
                    });
                } else {
                    alert("Geolocation is not supported by your browser.");
                }
            };
        </script>
    </body>
</html>
